# å¯†ç é¢„æµ‹æœºå™¨å­¦ä¹ ä»£ç ä½¿ç”¨æŒ‡å—

## ğŸ“‹ ç›®å½•ç»“æ„

```
ml_code/
â”œâ”€â”€ 1_data_preprocessing.py      # æ•°æ®é¢„å¤„ç†
â”œâ”€â”€ 2_feature_extraction.py      # ç‰¹å¾æå–
â”œâ”€â”€ 3_train_model.py             # æ¨¡å‹è®­ç»ƒ
â”œâ”€â”€ 4_predict_password.py        # å¯†ç é¢„æµ‹
â”œâ”€â”€ run_all.py                   # ä¸€é”®è¿è¡Œè„šæœ¬
â””â”€â”€ README.md                    # æœ¬æ–‡ä»¶
```

## ğŸ”§ ç¯å¢ƒå‡†å¤‡

### 1. å®‰è£…ä¾èµ–åŒ…

```bash
pip install pandas numpy scikit-learn scipy matplotlib seaborn joblib
```

### 2. å¯é€‰ï¼šå®‰è£… XGBoostï¼ˆæ¨èï¼‰

```bash
pip install xgboost
```

## ğŸ“Š ä½¿ç”¨æµç¨‹

### å®Œæ•´æµç¨‹ï¼ˆæ¨èï¼‰

ä½¿ç”¨ `run_all.py` ä¸€é”®è¿è¡Œæ‰€æœ‰æ­¥éª¤ï¼š

```bash
# ä» ml_code ç›®å½•è¿è¡Œ
python run_all.py --data_dir ../sensor_data/files --model random_forest
```

### åˆ†æ­¥æ‰§è¡Œ

#### æ­¥éª¤ 1: æ•°æ®é¢„å¤„ç†

**ç›®çš„**ï¼šå°†åŸå§‹ CSV æ–‡ä»¶æŒ‰æŒ‰é”®äº‹ä»¶åˆ†å‰²

```bash
python 1_data_preprocessing.py \
    --data_dir ../sensor_data/files \
    --output ./processed_data
```

**è¾“å…¥**ï¼š
- `../sensor_data/files/` ç›®å½•ä¸‹çš„æ‰€æœ‰ `password_training_*.csv` æ–‡ä»¶

**è¾“å‡º**ï¼š
- `processed_data/keypress_0000_label_5.csv` - å•ä¸ªæŒ‰é”®æ•°æ®
- `processed_data/keypress_0001_label_3.csv` - ...
- `processed_data/label_statistics.csv` - æ ‡ç­¾ç»Ÿè®¡

---

#### æ­¥éª¤ 2: ç‰¹å¾æå–

**ç›®çš„**ï¼šä»ä¼ æ„Ÿå™¨æ•°æ®ä¸­æå–æœºå™¨å­¦ä¹ ç‰¹å¾

```bash
python 2_feature_extraction.py \
    --input ./processed_data \
    --output ./features.csv
```

**æå–çš„ç‰¹å¾ç±»å‹**ï¼š
- **æ—¶åŸŸç‰¹å¾**ï¼šå‡å€¼ã€æ ‡å‡†å·®ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€ä¸­ä½æ•°ã€èŒƒå›´ã€RMSã€ååº¦ã€å³°åº¦ã€åˆ†ä½æ•°ã€è¿‡é›¶ç‡
- **é¢‘åŸŸç‰¹å¾**ï¼šFFT èƒ½é‡ã€é¢‘è°±å‡å€¼/æ ‡å‡†å·®ã€ä¸»é¢‘ç‡ã€é¢‘è°±è´¨å¿ƒ

**è¾“å…¥**ï¼š
- `processed_data/` ç›®å½•ä¸‹çš„æ‰€æœ‰ `keypress_*.csv` æ–‡ä»¶

**è¾“å‡º**ï¼š
- `features.csv` - ç‰¹å¾çŸ©é˜µï¼ˆæ¯è¡Œæ˜¯ä¸€æ¬¡æŒ‰é”®ï¼Œæ¯åˆ—æ˜¯ä¸€ä¸ªç‰¹å¾ï¼‰

---

#### æ­¥éª¤ 3: è®­ç»ƒæ¨¡å‹

**ç›®çš„**ï¼šè®­ç»ƒåˆ†ç±»æ¨¡å‹é¢„æµ‹æ•°å­—ï¼ˆ0-9ï¼‰

```bash
# Random Forest (æ¨è)
python 3_train_model.py \
    --features ./features.csv \
    --model random_forest

# XGBoost (æ€§èƒ½æ›´å¥½ï¼Œéœ€è¦å®‰è£…)
python 3_train_model.py \
    --features ./features.csv \
    --model xgboost

# SVM
python 3_train_model.py \
    --features ./features.csv \
    --model svm

# Logistic Regression
python 3_train_model.py \
    --features ./features.csv \
    --model logistic
```

**ä½¿ç”¨çš„ç®—æ³•**ï¼š

1. **Random Forestï¼ˆéšæœºæ£®æ—ï¼‰**
   - é›†æˆå­¦ä¹ ç®—æ³•
   - å¤šæ£µå†³ç­–æ ‘æŠ•ç¥¨
   - ä¼˜ç‚¹ï¼šå‡†ç¡®ç‡é«˜ï¼ŒæŠ—è¿‡æ‹Ÿåˆï¼Œå¯è§£é‡Šæ€§å¼º
   - ç¼ºç‚¹ï¼šæ¨¡å‹è¾ƒå¤§
   - è¶…å‚æ•°ï¼š100 æ£µæ ‘ï¼Œæœ€å¤§æ·±åº¦ 20

2. **XGBoost**
   - æ¢¯åº¦æå‡æ ‘
   - é¡ºåºæ„å»ºæ ‘ï¼Œæ¯æ£µæ ‘ä¿®æ­£å‰é¢çš„é”™è¯¯
   - ä¼˜ç‚¹ï¼šé€šå¸¸æœ€é«˜å‡†ç¡®ç‡
   - ç¼ºç‚¹ï¼šè®­ç»ƒè¾ƒæ…¢
   - è¶…å‚æ•°ï¼š100 æ£µæ ‘ï¼Œæ·±åº¦ 6ï¼Œå­¦ä¹ ç‡ 0.1

3. **SVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰**
   - å¯»æ‰¾æœ€ä¼˜åˆ†ç±»è¶…å¹³é¢
   - ä¼˜ç‚¹ï¼šé€‚åˆå°æ•°æ®é›†
   - ç¼ºç‚¹ï¼šè®­ç»ƒæ…¢ï¼Œå‚æ•°æ•æ„Ÿ
   - è¶…å‚æ•°ï¼šRBF æ ¸ï¼ŒC=10

4. **Logistic Regressionï¼ˆé€»è¾‘å›å½’ï¼‰**
   - çº¿æ€§åˆ†ç±»å™¨
   - ä¼˜ç‚¹ï¼šç®€å•å¿«é€Ÿï¼Œå¯è§£é‡Š
   - ç¼ºç‚¹ï¼šå‡†ç¡®ç‡å¯èƒ½è¾ƒä½

**è¾“å‡º**ï¼š
- `models/random_forest_20250115_123456.pkl` - ä¿å­˜çš„æ¨¡å‹
- `confusion_matrix_random_forest.png` - æ··æ·†çŸ©é˜µå›¾
- `feature_importance_random_forest.png` - ç‰¹å¾é‡è¦æ€§å›¾ï¼ˆRF/XGBoostï¼‰

**è¯„ä¼°æŒ‡æ ‡**ï¼š
- å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰
- ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰
- å¬å›ç‡ï¼ˆRecallï¼‰
- F1 åˆ†æ•°
- æ··æ·†çŸ©é˜µ

---

#### æ­¥éª¤ 4: é¢„æµ‹å¯†ç 

**ç›®çš„**ï¼šä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹é¢„æµ‹æ–°çš„å¯†ç åºåˆ—

```bash
python 4_predict_password.py \
    --model ./models/random_forest_20250115_123456.pkl \
    --data ./new_password_data.csv \
    --actual 12345  # å¯é€‰ï¼Œç”¨äºè¯„ä¼°
```

**è¾“å…¥**ï¼š
- è®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶
- æ–°çš„å¯†ç è¾“å…¥æ•°æ®ï¼ˆCSV æ ¼å¼ï¼‰
- ï¼ˆå¯é€‰ï¼‰å®é™…å¯†ç ï¼Œç”¨äºè¯„ä¼°

**è¾“å‡º**ï¼š
- é¢„æµ‹çš„å¯†ç åºåˆ—
- æ¯ä¸ªæ•°å­—çš„ç½®ä¿¡åº¦
- å¦‚æœæä¾›äº†å®é™…å¯†ç ï¼Œæ˜¾ç¤ºå‡†ç¡®ç‡

---

## ğŸ¯ å®Œæ•´ç¤ºä¾‹

### 1. å‡†å¤‡æ•°æ®

```bash
# å›åˆ°é¡¹ç›®æ ¹ç›®å½•
cd /Users/east/AndroidStudioProjects/iotproject

# ä½¿ç”¨è„šæœ¬ä»æ‰‹æœºå¯¼å‡ºæ•°æ®ï¼ˆæ¨èï¼‰
./export_data.sh

# æˆ–è€…æ‰‹åŠ¨å¯¼å‡º
# adb -s RFCXA1767LX pull /sdcard/Android/data/com.example.iotproject/files/ ./sensor_data/

# æ£€æŸ¥æ•°æ®
ls -lh sensor_data/files/
```

### 2. è¿è¡Œå®Œæ•´æµç¨‹

```bash
# è¿›å…¥ ml_code ç›®å½•
cd ml_code

# ä¸€é”®è¿è¡Œï¼ˆæ¨èï¼‰
python run_all.py --data_dir ../sensor_data/files --model random_forest

# æˆ–è€…åˆ†æ­¥è¿è¡Œ
python 1_data_preprocessing.py --data_dir ../sensor_data/files --output ./processed_data
python 2_feature_extraction.py --input ./processed_data --output ./features.csv
python 3_train_model.py --features ./features.csv --model random_forest
```

### 3. æµ‹è¯•é¢„æµ‹

```bash
# æ”¶é›†ä¸€ä¸ªæ–°çš„å¯†ç æ•°æ®ï¼ˆå‡è®¾å¯†ç æ˜¯ 54321ï¼‰
# åœ¨æ‰‹æœºä¸Šè¾“å…¥ï¼Œç„¶åå¯¼å‡º CSV

# é¢„æµ‹
python 4_predict_password.py \
    --model ./models/random_forest_xxx.pkl \
    --data ./test_password.csv \
    --actual 54321
```

---

## ğŸ“ˆ é¢„æœŸç»“æœ

### æ•°æ®é‡ä¸å‡†ç¡®ç‡å…³ç³»

| æ¯ä¸ªæ•°å­—çš„æ ·æœ¬æ•° | æ€»æ ·æœ¬æ•° | é¢„æœŸå‡†ç¡®ç‡ |
|-----------------|---------|-----------|
| 10              | 100     | 30-40%    |
| 50              | 500     | 50-65%    |
| 100             | 1000    | 60-75%    |
| 200+            | 2000+   | 70-85%    |

### ä¸åŒç®—æ³•çš„æ€§èƒ½æ¯”è¾ƒ

| ç®—æ³• | è®­ç»ƒé€Ÿåº¦ | é¢„æµ‹é€Ÿåº¦ | å‡†ç¡®ç‡ | æ¨èåº¦ |
|-----|---------|---------|--------|--------|
| Random Forest | â­â­â­ | â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| XGBoost | â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |
| SVM | â­ | â­â­ | â­â­â­ | â­â­ |
| Logistic Reg. | â­â­â­â­â­ | â­â­â­â­â­ | â­â­ | â­â­ |

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: å‡†ç¡®ç‡å¾ˆä½æ€ä¹ˆåŠï¼Ÿ

**å¯èƒ½åŸå› **ï¼š
1. æ•°æ®é‡å¤ªå°‘ï¼ˆ< 100 ä¸ªæ ·æœ¬ï¼‰
2. æ•°æ®è´¨é‡å·®ï¼ˆæŒ‰é”®å¤ªå¿«/å¤ªæ…¢ï¼‰
3. ç‰¹å¾ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ”¶é›†æ›´å¤šæ•°æ®ï¼ˆè‡³å°‘ 500 ä¸ªæ ·æœ¬ï¼‰
2. ç¡®ä¿æŒ‰é”®è‡ªç„¶ã€ç¨³å®š
3. å°è¯•ä¸åŒçš„æ¨¡å‹ï¼ˆXGBoostï¼‰
4. è°ƒæ•´è¶…å‚æ•°

### Q2: ç‰¹å¾æå–å¤±è´¥ï¼Ÿ

æ£€æŸ¥ï¼š
- CSV æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆåº”è¯¥æœ‰8åˆ—ï¼štimestamp, nanoTime, type, x, y, z, w, labelï¼‰
- æ˜¯å¦æœ‰ label åˆ—
- labelåˆ—æ˜¯å¦æœ‰æ•°æ®ï¼ˆå‰å‡ è¡Œå¯èƒ½æ˜¯ç©ºçš„ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼Œä¼šè¢«è‡ªåŠ¨è¿‡æ»¤ï¼‰
- æ•°æ®æ˜¯å¦åŒ…å«æ‰€æœ‰ä¼ æ„Ÿå™¨ç±»å‹ï¼ˆACC, GYRO, ROT_VEC, MAGï¼‰

**æ³¨æ„**ï¼šç¬¬ä¸€ä¸ªæŒ‰é”®çš„å‰500msæ•°æ®å¯èƒ½labelä¸ºç©ºï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œé¢„å¤„ç†è„šæœ¬ä¼šè‡ªåŠ¨å‰”é™¤ç©ºlabelçš„æ•°æ®

### Q3: å†…å­˜ä¸è¶³ï¼Ÿ

- å‡å°‘æ•°æ®é‡
- ä½¿ç”¨æ›´ç®€å•çš„æ¨¡å‹ï¼ˆLogistic Regressionï¼‰
- åˆ†æ‰¹å¤„ç†

### Q4: å¦‚ä½•æé«˜å‡†ç¡®ç‡ï¼Ÿ

1. **æ”¶é›†æ›´å¤šæ•°æ®**ï¼ˆæœ€é‡è¦ï¼ï¼‰
2. **æ•°æ®å¤šæ ·æ€§**ï¼šä¸åŒå§¿åŠ¿ã€æŒæ¡æ–¹å¼
3. **ç‰¹å¾å·¥ç¨‹**ï¼šæ·»åŠ æ›´å¤šç‰¹å¾
4. **æ¨¡å‹è°ƒä¼˜**ï¼šè°ƒæ•´è¶…å‚æ•°
5. **é›†æˆå­¦ä¹ **ï¼šç»“åˆå¤šä¸ªæ¨¡å‹

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®å¤„ç†æµç¨‹

```
åŸå§‹ CSV â†’ æŒ‰ label åˆ†å‰² â†’ æå–ç‰¹å¾ â†’ æ ‡å‡†åŒ– â†’ è®­ç»ƒæ¨¡å‹
```

### ç‰¹å¾ç©ºé—´

æ¯æ¬¡æŒ‰é”®æå–çº¦ **200-300 ä¸ªç‰¹å¾**ï¼š
- 4 ç§ä¼ æ„Ÿå™¨ Ã— 3-4 è½´ Ã— 10+ æ—¶åŸŸç‰¹å¾ = 120+ ç‰¹å¾
- 4 ç§ä¼ æ„Ÿå™¨ Ã— 3-4 è½´ Ã— 7+ é¢‘åŸŸç‰¹å¾ = 80+ ç‰¹å¾

### æ¨¡å‹å·¥ä½œåŸç†

1. **è®­ç»ƒé˜¶æ®µ**ï¼š
   - è¾“å…¥ï¼šç‰¹å¾å‘é‡ï¼ˆ200+ ç»´ï¼‰
   - è¾“å‡ºï¼šæ•°å­—æ ‡ç­¾ï¼ˆ0-9ï¼‰
   - å­¦ä¹ ï¼šç‰¹å¾ â†’ æ ‡ç­¾çš„æ˜ å°„å…³ç³»

2. **é¢„æµ‹é˜¶æ®µ**ï¼š
   - è¾“å…¥ï¼šæ–°çš„ç‰¹å¾å‘é‡
   - è¾“å‡ºï¼šé¢„æµ‹çš„æ•°å­— + ç½®ä¿¡åº¦

---

## ğŸ“ é¡¹ç›®æŠ¥å‘Šå»ºè®®

åœ¨æŠ¥å‘Šä¸­åº”è¯¥åŒ…æ‹¬ï¼š

1. **æ–¹æ³•æè¿°**
   - æ•°æ®é¢„å¤„ç†æ­¥éª¤
   - ç‰¹å¾æå–æ–¹æ³•ï¼ˆæ—¶åŸŸ + é¢‘åŸŸï¼‰
   - é€‰æ‹©çš„ç®—æ³•åŠç†ç”±

2. **å®éªŒè®¾ç½®**
   - æ•°æ®é›†å¤§å°
   - è®­ç»ƒ/æµ‹è¯•é›†åˆ’åˆ†ï¼ˆ80/20ï¼‰
   - è¶…å‚æ•°è®¾ç½®

3. **ç»“æœ**
   - å‡†ç¡®ç‡ã€æ··æ·†çŸ©é˜µ
   - ç‰¹å¾é‡è¦æ€§åˆ†æ
   - ä¸åŒæ¨¡å‹çš„å¯¹æ¯”

4. **è®¨è®º**
   - ä¸ºä»€ä¹ˆèƒ½é¢„æµ‹å¯†ç ï¼Ÿ
   - éšç§é£é™©åˆ†æ
   - å±€é™æ€§å’Œæ”¹è¿›æ–¹å‘

---

**ç¥ä½ å®éªŒæˆåŠŸï¼æœ‰é—®é¢˜éšæ—¶é—®ã€‚**
